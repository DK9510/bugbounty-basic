## What are types of XXE attack
- **Exploiting XXE to retrieve files:** where an external entity is defining the contents of the file, and returned in the application's response.
- **Exploiting XXE to perform SSRF attack:** where an external entity is defined based on a URL to a back-end system.
- **Exploiting Blind XXE exfiltrate data out-of-band:** where sensitive data is transmitted from the application server to a system that the attacker controls
- **EXploiting Blind XXE to Retrieve data via error messages:** where the attacker can trigger a parsing error message containing sensitive data.

## Exploiting XXE to Retrieve Files.
- to perform XXE injection that retrieve file from the server , we need to modify the XML in two ways
	1. introduce or edit `DOCTYPE` element that defines an external entity containing the path to the file.
	2. Edit a data values in the XML that is returned in the application's response, to make use of defined external entities.
- example: shopping application check stock by submitting XML to the server
```js
<?XML version="1.0" encoding="UTF-8"?>
<stockcheck><productId>381</productId></stockcheck>
```
- since the application didn't use any defense mechanism against XXE we exploit it and retrieve any file from server.
`exploit/ payload`
```js
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [ <!ENTITY xxe SYSTEM "file://etc/passwd" >]>
<stockcheck><productId>&xxe;</productId></stockcheck>
```

- here payload defines an external entity `&xxe;` whose value is `content of /etc/passwd` and uses the entity within the `productId` value, this cause application's response to induce the contents of the file.
- **Note:** ``With real-world XXE vulnerabilities, there will often be a large number of data values within the submitted XML, any one of which might be used within the application's response. To test systematically for XXE vulnerabilities, you will generally need to test each data node in the XML individually, by making use of your defined entity and seeing whether it appears within the response.``

## EXPLOITING XXE to perform SSRF
- aside from retrieving data other main impact of `XXE` is , it can be used to perform `SSRF`. 
- for exploiting `XXE to SSRF` we need to define external entity using the URL that we want to target.
- for doing two way interaction we need to put `ENTITY ` in defined entity that returned in the application's response with out it will `Blind SSRF` but it also critical vuln.

```js
<!DOCTYPE root [ <!ENTITY DK SYSTEM "http://internal.domain/" > ]>
```

