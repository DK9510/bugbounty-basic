# Check List for Web-Application Pen-test

# Recon Phase
- [ ] Identify web server, technologies, databases, where is hosted cloud, aws etc
- [ ] Subsidirary and Acquisition Enumeration
- [ ] Reverse Lookup
- [ ] ASN & IP space Enumeration and Service Enumeration
- [ ] Google Dorking
- [ ] Github Recon/Dorking
- [ ] Directory Enumeration
- [ ] IP range Enumeration
- [ ] JS Files Analysis
- [ ] Subdomain Enumeration & Bruteforcing
- [ ] Subdomain Takeover
- [ ] Parameter Fuzzing
- [ ] Port Scanning
- [ ] Template-based scanning(Nuclei)
- [ ] Wayback machine
- [ ] Broken Link Hijacking
- [ ] Internet Search Engine Discovery
- [ ] Misconfigured cloud storage /aws.s3 etc

# Registration feature Test
- [ ] Check For duplicate Registration/Overwrite existing user
- [ ] Check for Weak password policy
- [ ] Check for Reuse Existing usernames
- [ ] Check for insufficient email verification process
- [ ] Weak Registration implementation-allows disposable email addresses
- [ ] Weak registration implementation-Over HTTP
- [ ] put very long username/password that lead to DOS
- [ ] OverWrite default Web application pages by specially crafted username registration -> after registration, does our profile link appears `application.com/username` etc
	- [ ] if so, enumerate default folders of web application i.e `/images`,`/contact`, `/portfolio`
	- [ ] Do a registration using usernames such as `images, contact, portfolio`
	- [ ] check if the default folders have been overwritten by our profile link or not.

# Session Management Test
- [ ] identify actual session cookie out of bulk cookie in the application
- [ ] Decode cookies using std. decoding algo. `base64, hex, URLencoding, Base64URLencoding` etc
- [ ] Modify Cookies, session token value by `1 bit/byte`, and submit, do for all tokens , identify which part or which token is used for session management and which is not used.
- [ ] if self-registration is available and you can choose your username, log in with a series of similar usernames containing small variations between them, such as A, AA, AAA, AAAA, AAAB, AAAC, AABA, and so on. If another user-specific data is submitted at login or stored in user profiles (such as an email address)
- [ ] Check for session Cookies and its Expiration data/time
- [ ] Identify Cookie Domain Scope 
- [ ] Check For HttpOnly flag in cookie
- [ ] Check for Secure Flag in Cookie, if application is over SSL 
- [ ] Check for Session fixation i.e value of session cookie before & after authentication
- [ ] Replay The session cookie from different `IP` or `System` to check whether the server maintain the state of the machine or not
- [ ] Check for ConCurrent login through different `machine/IP`
- [ ] Check if any user pertaining information stored in cookie value, if yes temper with other user's data
- [ ] Failure to invalidate Session on `Email Change, 2FA activation`

# Authentication Testing
- [ ] username Enumeration
- [ ] Bypass Authentication using `SQL injection`
	- lack of password confirmation on
	- [ ] Change Email address
	- [ ] Change Password
	- [ ] Manage 2FA
- [ ] possible to use resource without authentication? access violation
- [ ] Check if User credentials are transmitted over SSL or Not
- [ ] Weak login function HTTP and HTTPS both are available 
	#### Test user account lockout mechanism on bruteforce attack
	#### variation: if server blocks instant user request, try with time throttle option in intruder
	- [ ] Bypass rate Limiting By tempering User agent to Mobile user agent
	- [ ] Bypass Rate Limit by Tempering user agent to Anonymous user-agent
	- [ ] Bypass Rate limit by `NULL Byte`
 - [ ] Create WordList Using `cewl` for password/directories
 
 # O-Auth Functionalities
 ## OAuth Roles
 - [ ] Resource Owner -> User
 - [ ] Resource Server -> from where the resource are fetched
 - [ ] Client Application -> which request for user's resource
 - [ ] Authorization Server -> server which grant resources
 - [ ] client_id -> public, non-secret unique identifier
 - [ ] Client_secret -> Secret token that needed when generating Oauth Token
 - [ ] Response_type -> token-type `code, token (id token JWT) etc`
 - [ ] Scope -> what resource about the user application wants
 - [ ] redirect_uri -> redirecting the user after completing authorization complete
 - [ ] state -> Main CSRF protection in OAuth
 - [ ] grant_type -> defines grant type & returned token type
 - [ ] code -> authorization code generated by twitter, to fetch `Access Token from the server`
 - [ ] access_token -> token used to make api request to fetch user's resource
 - [ ] refresh_token -> allow application to obtain new access_token without promting user
 ## Code Flows
 - [ ] re-using the code
 - [ ] Code predict/bruteforce
 - [ ] is the code for application `X` valid for application `Y`
 ## Redirect_Uri flows
 - [ ] Uri isn't validated at all `?redirect_uri=https://attacker.com`
 - [ ] Subdomain allowed (subdomain takeover/ open redirect to those subdomain) `?redirec_uri=https://sub.domain.com`
 - [ ] host is validated but path isn't (chain to openRedirect) `?redirect_uri=https://domain.com/callback?redirect_uri=https://attacker.com`
 - [ ] Host is validated, path isn't(Referer leakages): Include external content on HTML page and leak code via Referer
 - [ ] weak Regexes
 - [ ] Brute Forcing the URL Encoded Chars after host `?redirect_uri=https://domain.com/$FUZZ$`
 - [ ] Bruteforcing the keywords whitelist after host (or on any whitelist open redirect filter): ``?redirect_uri=https://§FUZZ§.com`
 - [ ] URI validation in place: use typical open redirect payloads
 ## State Flows
 - [ ] Missing State Parameter (CSRF)
 - [ ] Predictable State Parameter
 - [ ] Is state Parameter is being validated
 ## MISC
 - [ ] is client_secret validated
 - [ ] Pre ATO using facebook phone-number signup
 - [ ] No email validation pre ATO
 # Test 2FA Misconfiguration
 - [ ] Response Manipulation
 - [ ] Status COde
 - [ ] Manipulation
 - [ ] 2FA Code leakage in Response
 - [ ] 2FA Code Reusability
 - [ ] Lack of Brute Force Protection
 - [ ] Missing 2FA Code integrity validation
 - [ ] with `NULL` or `0000`
 # My account (Post Login) test
 - [ ] find parameter use active `user id`. try to temper it for change detail for other accounts
 - [ ] account details (Name, Number, Address, etc.) Try (CSRF)
 - [ ] post Login, change email id and update with existing email id.. Check if its getting validated on server side or not. Does the application send any new email confirmation link to a new user or not? What if a user does not confirm the link in some time frame?
 - [ ] Open profile picture in a new tab and check the URL. Find email id/user id info. EXIF Geolocation Data Not Stripped From Uploaded Images.
 - [ ] Check account deletion option if application provides it and confirm that via forgot password feature
 - [ ] Change email id, account id, user id, and try to brute force other user's password
 - [ ] Check whether application re authenticate for performing sensitive operation for post authentication feature
 # Forgot password Test
 - [ ] Failure to invalidate session on logout and password reset
 - [ ] Check if forgot password reset link/code uniques
 - [ ] Check is reset link does get expire or not if not used by certain amount of time
 - [ ] Find user account identification parameter and tamper Id or parameter value to change other user's password
 - [ ] Check for weak password policy
 - [ ] Weak password reset Implementation, token is not invalidated after in use
 - [ ] if reset link has another parameter i.e `date and time`, change the value of date and time to make active & valid reset link
 - [ ] Check is Security Questions are asked, how many guess allowed, lockout policy maintened or not
 - [ ] add only spaces in new password and confirm password, submit request and see result
 - [ ] does it display old password on the same page after completion of forgot password
 - [ ] ask for 2 password reset link and use the older one from the user's email
 - [ ] Check for active Session destroyed when password reset
 - [ ] Weak password reset-implementation, password reset token sent over HTTP
 - [ ] send continuous forget password request so that it may send sequential tokens
# Contact Us Form test
- [ ] is CAPTCHA implemented for Email Flooding attack
- [ ] Does it allow to Upload File on the server
- [ ] Blind XSS
# Product purchase Test
### BUY now
   - [ ] temper Product ID to purchase Other High valued Product with Low prize
   - [ ] Temper product data in order to Increase the Number of product with the same price
### Gift/Voucher
   - [ ] Temper gift/voucher count in the request(if any) to increase the number of vouchers/gift to be used
   - [ ] Temper gift/voucher value to increase/decrease the value of the voucher in terms of money
   - [ ] Reuse Gift/voucher by using old gift values in parameter tempering
   - [ ] Check the uniqueness of gift/voucher parameter and try guessing other gift/voucher code
   - [ ] Use parameter pollution technique to add the same voucher twice by adding same parameter name and value again 
  ### Add/Delete Product from cart
  - [ ] Temper user id to delete products from other user's cart
  - [ ] Temper cart id to add/delete product from other user's cart
  - [ ] Identify cart/user id for cart feature to view the added items from other user's account
  ### Address
  - [ ] Temper request to change other user's address to yours
  - [ ] Try stored XSS on it
  - [ ] use parameter pollution technique to add two shipping address instead of one trying to manipulate application to send same item on two shipping address
  ### place Order
  - [ ] Temper Payment option parameter to change payment methods.`place cash on delivery on can not orderd to cash on delivery item`
  - [ ] Temper the amount value for payment
  - [ ] Check if CVV is going to clear text
  - [ ] Check if application it self processes card details and performs transection or use any third party services
  ### track Order
  - [ ] track other user's order by guessing order tracking number
  - [ ] Brute force tracking number prefix or suffix to track mass orders of other users
  ### wish list Page
  - [ ] Check is a user A can add/remove products in wishlists of other user B's account
  - [ ] check whether user A can add order to cart from wishlist of other users
  ### Post Product Purchasing Test
  - [ ] check is user A can cancel order of user B
  - [ ] check if A can view/check orders placed by B
  - [ ] Check if A can modify the shipping address of placed order by user B
  ### Out of Band test OAST
  - [ ] can user order product which is out of stock
  
  # banking Application Test
  ## Billing Activity
  - [ ] Check User A can view acc statement of B
  - [ ] Check A can view transaction report of B
  - [ ] Check A can view summery report of B
  - [ ] Check A can register for monthly acc statement via email behalf of user B
  - [ ] check if A can update existing email id of user B 
  ## Deposit/loan/linked/external account checking
  - [ ] check A can view Deposit amount of B
  - [ ] Check for account balance tempering for deposit account
  ## Tax deduction inquiry Test
  - [ ] Check A can view tax deduction details by manipulating `customer id` 
  - [ ] check for parameter tempering for increasing/decreasing interest Rate, amount, refund
  - [ ] check A can download TDS details of B
  - [ ] Check if A can request Cheque book for B
  ## Fixed Deposit account test
  - [ ] check if A can create FD account behalf of B
  - [ ] Check is user can open FD account with more amount then the current account balance
  ## status Entry Test
  - [ ] A can view status enquiry of B
  - [ ] A can modify status Enquiry of B
  - [ ] A can post and equiry behalf of B from own acc.
  ## Fund transfer Test
  - [ ] Is it possible to transfer funds to user 'C' instead of user 'B' from the user 'A' which was intended to transfer from user 'A' to user 'B'
  - [ ] can fund transfer amount can be manipulated
  - [ ] can A can modify the payee list of B by param manipulation of own account
  - [ ] is it possible to add payee without any proper validation in A's own account or B's account
  ##  Schedule Transfer test
  - [ ] can A can view schedule transfer of B
  - [ ] Can A change the details of Schedule transfer for B
 # OPEN Redirecction test
 ## Common Injection parameter
 ```bash
/{payload}
?next={payload}
?url={payload}
?target={payload}
?rurl={payload}
?dest={payload}
?destination={payload}
?redir={payload}
?redirect_uri={payload}
?redirect_url={payload}
?redirect={payload}
/redirect/{payload}
/cgi-bin/redirect.cgi?{payload}
/out/{payload}
/out?{payload}
?view={payload}
/login?to={payload}
?image_url={payload}
?go={payload}
?return={payload}
?returnTo={payload}
?return_to={payload}
?checkout_url={payload}
?continue={payload}
?return_path={payload}
```

- [ ] user burp `find` parameter such as `url,red,redirect,origin,redirect_uri` etc
- [ ] Check the value of these parameter which may contain URL
- [ ] change the URL value to `anydomain.com`, see if redirect
- [ ] try single `/` or `url encoding`
- [ ] using White listed domain or keyword
- [ ] using `//` to bypass http blacklisted keyword
- [ ] using `https:` to bypass `//` blacklisted keyword
- [ ] using `\/\/` to bypass`//` blacklisted keyword
- [ ] using `null byte %00` to bypass blacklist filter

# host header injection
- [ ] supply arbitrary host header
- [ ] check for flawed validation
	### send ambigious requests
	- [ ] inject duplicate headers
	- [ ] supply an absolute URL
	- [ ] add line wrapping
 - [ ] inject host override headers
 
 # SQL injection test
 ## Entry Point detection
 - [ ] Simple characters
 - [ ] multiple encoding
 - [ ] merging characters
 - [ ] logic testing
 - [ ] weird characters
 ## Use SQLmap to identify vulnerable parameters
 - [ ] go to request that submit form or other and copy request to file , and save and run sqlmap using `sqlmap -r file proxy=https://127.0.0.1:8080`
 ## Bypass WAF 
 - [ ] using `NUll BYte` before SQL query
 - [ ] using SQL inline comment sequence
 - [ ] URL encoding
 - [ ] Changing cases
 - [ ] use SQLmap temper scripts
 ## Time delays
 |data base| query|
 |---|---|
 |Oracle|dbms_pipe.receive_message(('a'),10)|
 |Microsoft| WAITFOR DELAY '0:0:10'|
 |PostgreSQL| SELECT pg_sleep(10)|
 |MySQL| SELECT sleep(10)|
 
 ## Conditional Delays
 refer to [[SQL-Injection]]
 
 # Cross Site Scripting
 - [ ] Try XSS using tools like QuickXSS or KXSS
 - [ ] upload file using `'"><img src=x onerror=alert(document.domain)>.txt`
 - [ ] if scripts tag are banned then use `<h3>` and other `HTML` tags
 - [ ] if output is reflected back inside `js` as value of any variable, use `print(0), alert(0), promt(0), console.log(0)`
 - [ ] if `"` are blocked than use `/><img src=x onerror=confirm(/DK9510/);>`
 - [ ] upload `javascript` using image file
 - [ ] unusual way to execute JS payload to change method from `POST` to `GET`, it bypass filters sometimes
 - [ ] Syntax encoding payload `"%3cscript%3epromt(document.cookie)%3c/script%3e"`
  ## filter Evasion
  - [ ] `<>`can be replace with HTML entities `&lt; &gt;` we try XSS polyglot `refere portswigger` `→</title></style></textarea></script></xmp><svg/onload='+/"/+/onmouseover=1/+/[/[]/+alert(1)//'>`
  ## Firewall bypass
  - [ ] check if firewall blocking only lowercase
  - [ ] try to break firewall regex using newline `\r\n`
  - [ ] Try double encode or tripple encode
  - [ ] testing for recursive filters
  - [ ] injecting anchor tag without whitespace
  - [ ] try bypass whitespace with `Bullet`
  - [ ] try change request methods
  
 # CSRF Test
  - [ ] validation of CSRF token depends on request method
  - [ ] validation of CSRF token depends on Token present
  - [ ] CSRF token is not tied to non-session cookie
  - [ ] validation of Referer depends on header being present
 
 # SAML valun
 - [ ] signature wapping (XSW) Attacks
 - [ ] SAML Message integrity abuse
 - [ ] Missing/invalid Replay
 - [ ] Token recipient confusion
 
 # XML injection
 - [ ] change content type to `text/xml` and inject XML entity with DTD
 ```xml
<?xml version="1.1" encoding="ISO 8859 1"?>
<!DOCTYPE DK [<!ELEMENT DK ANY [<!ENTITY dk9510 SYSTEM "file:///etc/passwd" >]> <DK>&dk9510;</]
```
- [ ] blind XXE out of band interaction
[[XXE-injection]]

# Cross Origin Resource Sharing
- [ ] Errors parsing Origin headers
- [ ] Whitelisted Null Origin value [[CORS-Cross-origin-resource-sharing]]

# SSRF
## Common injection parameter
```bash
"access=",
"admin=",
"dbg=",
"debug=",
"edit=",
"grant=",
"test=",
"alter=",
"clone=",
"create=",
"delete=",
"disable=",
"enable=",
"exec=",
"execute=",
"load=",
"make=",
"modify=",
"rename=",
"reset=",
"shell=",
"toggle=",
"adm=",
"root=",
"cfg=",
"dest=",
"redirect=",
"uri=",
"path=",
"continue=",
"url=",
"window=",
"next=",
"data=",
"reference=",
"site=",
"html=",
"val=",
"validate=",
"domain=",
"callback=",
"return=",
"page=",
"feed=",
"host=",
"port=",
"to=",
"out=",
"view=",
"dir=",
"show=",
"navigation=",
"open=",
"file=",
"document=",
"folder=",
"pg=",
"php_path=",
"style=",
"doc=",
"img=",
"filename="
```
- [ ] try basic local host
## bypassing Filters
- [ ] Bypass using HTTPS
- [ ] Bypass using `[::]` or `ipv6`
- [ ] Bypass with a domain redirection
- [ ] Bypass using a decimal ip location
- [ ] bypass using ipv4/ipv6 addresd embedding
- [ ] Bypass using malformed URLs
- [ ] Bypass using rare address(short-hand ip address by dropping zeros)
- [ ] Bypass using Enclosed alphanumerics
## Cloud Instances
### AWS
```bash
http://instance-data
http://169.254.169.254
http://169.254.169.254/latest/user-data
http://169.254.169.254/latest/user-data/iam/security-credentials/[ROLE NAME]
http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE NAME]
http://169.254.169.254/latest/meta-data/iam/security-credentials/PhotonInstance
http://169.254.169.254/latest/meta-data/ami-id
http://169.254.169.254/latest/meta-data/reservation-id
http://169.254.169.254/latest/meta-data/hostname
http://169.254.169.254/latest/meta-data/public-keys/
http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key
http://169.254.169.254/latest/meta-data/public-keys/[ID]/openssh-key
http://169.254.169.254/latest/meta-data/iam/security-credentials/dummy
http://169.254.169.254/latest/meta-data/iam/security-credentials/s3access
http://169.254.169.254/latest/dynamic/instance-identity/document
```

### Google Cloud
```bash
http://169.254.169.254/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/
http://metadata/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/instance/hostname
http://metadata.google.internal/computeMetadata/v1/instance/id
http://metadata.google.internal/computeMetadata/v1/project/project-id
```

### Digital Ocean
```bash
curl http://169.254.169.254/metadata/v1/id
http://169.254.169.254/metadata/v1.json
http://169.254.169.254/metadata/v1/
http://169.254.169.254/metadata/v1/id
http://169.254.169.254/metadata/v1/user-data
http://169.254.169.254/metadata/v1/hostname
http://169.254.169.254/metadata/v1/region
http://169.254.169.254/metadata/v1/interfaces/public/0/ipv6/address
```

### Microsoft Azure
```bash
http://169.254.169.254/metadata/v1/maintenance
http://169.254.169.254/metadata/instance?api-version=2017-04-02
http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2017-04-02&f
ormat=text
```
- [ ] Bypassing via Open redirect

# File Upload
- [ ] Upload the malicious file to the archive upload functionality and observe how the application responds
- [ ] if application supports pdf, DOCX files then test for XXE
- [ ] Upload a file and change its path to overwrite an existing system file
- [ ] large file DOS
- [ ] Metadata leakage
- [ ] ImageMagic Library attacks
- [ ] Pixel Flood attack
 ## Bypass
   - [ ] Null byte `%00` Bypass
   - [ ] Content-Type bypass
   - [ ] Magic Byte Bypass
   - [ ] Client-side Validation bypass
   - [ ] Black-Listed Extension Bypass
   - [ ] Homographic Character bypass

# CAPTCHA testing
- [ ] Missing Captcha Field integrity checks
- [ ] HTTP ver manipulation
- [ ] Content-Type Conversion
- [ ] Reusable Captcha

# JWT token Test
- [ ] brute forcing secret Keys
- [ ] Signing a new Token with the `none` algorithm
- [ ] Changing the Signing algorithm of the token (for fuzzing )
- [ ] Signing the Asymmetrically-signed token to its symmetric algorithms match

# Websocket test
- [ ] Intercept and modify WebSocket Messages
- [ ] WebSocket MITM attempts
- [ ] Testing Secret header  websocket
- [ ] Content stealing in Websocket
- [ ] Token authentication testing in websocket

# GraphQL vulnerabilities test
- [ ] Inconsistent Authorization checks
- [ ] Missing Validation of Custom scalars
- [ ] Failure to approproately rate limit
- [ ] Introspection Query Enabled/Disabled

# Wordpress Common Vulnerability
- [ ] XSPA in Wordspress
- [ ] Brute Force in wp-login.php
- [ ] Information Disclosure wordpress username
- [ ] backup file wp-config exposed
- [ ] log files exposed
- [ ] DOS via load-styles.php
- [ ] DOS via load-Scripts.php
- [ ] DDOD using xmlrpc.php

# Denial of Service (DOS)
- [ ] Cookie bomb
- [ ] Pixel Flood, using image with huge pixels
- [ ] Frame Flood, using GIF with a huge frame
- [ ] ReDOS (regex DOS)
- [ ] CPDOS(cache poisoning DOS)

# other Test Cases 
## Checks for Security Headers 
- [ ] X frame OPtion
- [ ] X xss header
- [ ] HSTS header
- [ ] CSP header
- [ ] Referrer Policy
- [ ] Cache control
- [ ] Public Key pins
## Tesing for role Authorization
- [ ] check if normal user can access the resource of high privileged users
- [ ] Forced browsing
- [ ] IDOR
- [ ] Param tempering to switch user account to high privileged
## Blind RCE
- [ ] using time Delays
- [ ] by redirecting out put
- [ ] With Out-of-band interaction (OAST)
- [ ] with out-of-band data exfilteration

- [ ] command injection on CSV export(upload/download)
- [ ] CSV Excel Macro Injection
- [ ] found phpinfo.php file, then check configuration leakage and try to exploit any network vulnerability
- [ ] Parameter Pollution social media sharing Button

## Broken Cryptography 
   - [ ] Cryptography implementation flow
   - [ ] Encryption information compromised 
   - [ ] weak Cipher used for encryption
 ## Web service test
   - [ ] Directory traversal
   - [ ] web service documentation disclosure enumeration of service, data types  input boundaries and limits
  